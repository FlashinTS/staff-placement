<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .container {
            display: flex;
            gap: 20px;
            height: 70vh;
        }
        .work-areas {
            flex: 3;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .employees-status {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-left: 1px solid #ccc;
            padding-left: 20px;
            height: 100%;
        }
        .status-section {
            margin-bottom: 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .status-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .status-content {
            flex: 1;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            height: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            position: sticky;
            top: 0;
        }
        .employee-item {
            padding: 5px;
            margin: 5px 0;
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }
        .employee-item.assigned {
            background-color: #d4edda;
        }
        .employee-item.vacation {
            background-color: #fff3cd;
        }
        .employee-item.sick {
            background-color: #f8d7da;
        }
        .employee-item.dayoff {
            background-color: #e2e3e5;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        button {
            padding: 8px 16px;
            cursor: pointer;
        }
        .counter {
            font-weight: bold;
            margin-left: auto;
        }
        .archive {
            margin-top: 20px;
        }
        .archive-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .archive-item:hover {
            background-color: #f0f0f0;
        }
        .archive-item-controls {
            display: flex;
            gap: 5px;
        }
        .archive-item-name {
            cursor: pointer;
            flex-grow: 1;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            text-align: center;
            min-width: 300px;
        }
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        .remove-employee {
            color: red;
            cursor: pointer;
            margin-left: 5px;
        }
        .status-controls {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }
        .status-btn {
            padding: 2px 5px;
            font-size: 12px;
            cursor: pointer;
        }
        .vacation-btn {
            background-color: #fff3cd;
        }
        .sick-btn {
            background-color: #f8d7da;
        }
        .dayoff-btn {
            background-color: #e2e3e5;
        }
        .active-btn {
            background-color: #d4edda;
        }
        .employee-name {
            display: inline-block;
            margin-right: 5px;
        }
        .employee-assigned {
            display: inline;
        }
        .area-employees {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .table-container {
            height: 100%;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞</h1>
    
    <div class="controls">
        <button id="saveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É</button>
        <button id="clearBtn">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
        <div class="counter">–†–∞—Å—Å—Ç–∞–≤–ª–µ–Ω–æ: <span id="assignedCount">0</span></div>
    </div>
    
    <div class="container">
        <div class="work-areas">
            <h2>–£—á–∞—Å—Ç–∫–∏</h2>
            <div class="table-container">
                <table id="areasTable">
                    <thead>
                        <tr>
                            <th style="width: 30%;">–£—á–∞—Å—Ç–æ–∫</th>
                            <th style="width: 70%;">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</th>
                        </tr>
                    </thead>
                    <tbody id="areasBody">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∏–∑ JS -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="employees-status">
            <h2>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</h2>
            
            <div class="status-section">
                <div class="status-title">–ù–∞ —Ä–∞–±–æ—Ç–µ</div>
                <div class="status-content" id="activeEmployees"></div>
            </div>
            
            <div class="status-section">
                <div class="status-title">–í –æ—Ç–ø—É—Å–∫–µ</div>
                <div class="status-content" id="vacationEmployees"></div>
            </div>
            
            <div class="status-section">
                <div class="status-title">–ù–∞ –±–æ–ª—å–Ω–∏—á–Ω–æ–º</div>
                <div class="status-content" id="sickEmployees"></div>
            </div>
            
            <div class="status-section">
                <div class="status-title">–í –æ—Ç–≥—É–ª–µ</div>
                <div class="status-content" id="dayoffEmployees"></div>
            </div>
        </div>
    </div>
    
    <div class="archive">
        <h2>–ê—Ä—Ö–∏–≤ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–æ–∫</h2>
        <div id="archiveList"></div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ -->
    <div class="modal" id="confirmClearModal">
        <div class="modal-content">
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —É—á–∞—Å—Ç–∫–∏?</p>
            <div class="modal-buttons">
                <button id="confirmClearYes">–î–∞</button>
                <button id="confirmClearNo">–ù–µ—Ç</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è -->
    <div class="modal" id="confirmDeleteModal">
        <div class="modal-content">
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É?</p>
            <div class="modal-buttons">
                <button id="confirmDeleteYes">–î–∞</button>
                <button id="confirmDeleteNo">–ù–µ—Ç</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è -->
    <div class="modal" id="editNameModal">
        <div class="modal-content">
            <p>–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:</p>
            <input type="text" id="editNameInput" class="edit-input">
            <div class="modal-buttons">
                <button id="confirmEditName">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button id="cancelEditName">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    
    <script>
        // –î–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–æ–≤ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞)
        let employeesData = [
            { id: 1, name: "–ò–≤–∞–Ω–æ–≤ –ò.–ò.", status: "active" },
            { id: 2, name: "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", status: "active" },
            { id: 3, name: "–°–∏–¥–æ—Ä–æ–≤ –°.–°.", status: "vacation" },
            { id: 4, name: "–ö—É–∑–Ω–µ—Ü–æ–≤ –ö.–ö.", status: "active" },
            { id: 5, name: "–°–º–∏—Ä–Ω–æ–≤–∞ –ê.–ê.", status: "sick" },
            { id: 6, name: "–í–∞—Å–∏–ª—å–µ–≤ –í.–í.", status: "dayoff" },
            { id: 7, name: "–ù–∏–∫–æ–ª–∞–µ–≤–∞ –ù.–ù.", status: "active" },
            { id: 8, name: "–§–µ–¥–æ—Ä–æ–≤ –§.–§.", status: "active" }
        ];
        
        const areasData = [
            { id: 1, name: "–£—á–∞—Å—Ç–æ–∫ 1" },
            { id: 2, name: "–£—á–∞—Å—Ç–æ–∫ 2" },
            { id: 3, name: "–£—á–∞—Å—Ç–æ–∫ 3" },
            { id: 4, name: "–£—á–∞—Å—Ç–æ–∫ 4" }
        ];
        
        // –¢–µ–∫—É—â–∞—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞
        let currentAssignment = {};
        let archive = [];
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        let itemToDelete = null;
        let itemToEdit = null;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            renderAreas();
            renderEmployees();
            updateCounter();
            loadArchive();
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.getElementById('saveBtn').addEventListener('click', saveAssignment);
            document.getElementById('clearBtn').addEventListener('click', showConfirmClearModal);
            document.getElementById('confirmClearYes').addEventListener('click', clearAllAssignments);
            document.getElementById('confirmClearNo').addEventListener('click', hideConfirmClearModal);
            document.getElementById('confirmDeleteYes').addEventListener('click', deleteArchiveItem);
            document.getElementById('confirmDeleteNo').addEventListener('click', hideConfirmDeleteModal);
            document.getElementById('confirmEditName').addEventListener('click', saveEditedName);
            document.getElementById('cancelEditName').addEventListener('click', hideEditNameModal);
        }
        
        // –†–µ–Ω–¥–µ—Ä —Ç–∞–±–ª–∏—Ü—ã —É—á–∞—Å—Ç–∫–æ–≤
        function renderAreas() {
            const areasBody = document.getElementById('areasBody');
            areasBody.innerHTML = '';
            
            areasData.forEach(area => {
                const row = document.createElement('tr');
                row.dataset.areaId = area.id;
                
                const areaNameCell = document.createElement('td');
                areaNameCell.textContent = area.name;
                
                const employeesCell = document.createElement('td');
                employeesCell.className = 'employees-cell area-employees';
                employeesCell.dataset.areaId = area.id;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å –Ω–∞ —ç—Ç–æ–º —É—á–∞—Å—Ç–∫–µ
                if (currentAssignment[area.id]) {
                    const employeesNames = currentAssignment[area.id].map(empId => {
                        const emp = employeesData.find(e => e.id == empId);
                        return emp ? emp.name : '';
                    }).join(', ');
                    
                    employeesCell.textContent = employeesNames;
                } else {
                    employeesCell.textContent = '–ù–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤';
                }
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
                employeesCell.addEventListener('dragover', dragOver);
                employeesCell.addEventListener('drop', drop);
                
                row.appendChild(areaNameCell);
                row.appendChild(employeesCell);
                
                areasBody.appendChild(row);
            });
        }
        
        // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
        function renderEmployees() {
            renderEmployeeStatus('active', 'activeEmployees');
            renderEmployeeStatus('vacation', 'vacationEmployees');
            renderEmployeeStatus('sick', 'sickEmployees');
            renderEmployeeStatus('dayoff', 'dayoffEmployees');
        }
        
        // –†–µ–Ω–¥–µ—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å—Ç–∞—Ç—É—Å—É
        function renderEmployeeStatus(status, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            employeesData
                .filter(employee => employee.status === status)
                .forEach(employee => {
                    // –î–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –ª–∏ –æ–Ω–∏ —É–∂–µ
                    if (status === 'active' && isEmployeeAssigned(employee.id)) {
                        return;
                    }
                    
                    const empDiv = document.createElement('div');
                    empDiv.className = `employee-item ${status}`;
                    empDiv.dataset.employeeId = employee.id;
                    
                    const nameSpan = document.createElement('span');
                    nameSpan.className = 'employee-name';
                    nameSpan.textContent = employee.name;
                    empDiv.appendChild(nameSpan);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è –¥–ª—è —Å—Ç–∞—Ç—É—Å–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
                    if (status !== 'active') {
                        const removeBtn = document.createElement('span');
                        removeBtn.className = 'remove-employee';
                        removeBtn.innerHTML = '&times;';
                        removeBtn.title = '–í–µ—Ä–Ω—É—Ç—å –≤ —Ä–∞–±–æ—Ç—É';
                        removeBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            changeEmployeeStatus(employee.id, 'active');
                        });
                        empDiv.appendChild(removeBtn);
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
                    empDiv.draggable = true;
                    empDiv.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', employee.id);
                        e.dataTransfer.setData('source', 'employees-list');
                        e.dataTransfer.setData('status', employee.status);
                    });
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–º –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
                    if (status === 'active') {
                        const controlsDiv = document.createElement('div');
                        controlsDiv.className = 'status-controls';
                        
                        const vacationBtn = document.createElement('button');
                        vacationBtn.className = 'status-btn vacation-btn';
                        vacationBtn.textContent = '–û—Ç–ø—É—Å–∫';
                        vacationBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            changeEmployeeStatus(employee.id, 'vacation');
                        });
                        
                        const sickBtn = document.createElement('button');
                        sickBtn.className = 'status-btn sick-btn';
                        sickBtn.textContent = '–ë–æ–ª—å–Ω–∏—á–Ω—ã–π';
                        sickBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            changeEmployeeStatus(employee.id, 'sick');
                        });
                        
                        const dayoffBtn = document.createElement('button');
                        dayoffBtn.className = 'status-btn dayoff-btn';
                        dayoffBtn.textContent = '–û—Ç–≥—É–ª';
                        dayoffBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            changeEmployeeStatus(employee.id, 'dayoff');
                        });
                        
                        controlsDiv.appendChild(vacationBtn);
                        controlsDiv.appendChild(sickBtn);
                        controlsDiv.appendChild(dayoffBtn);
                        empDiv.appendChild(controlsDiv);
                    }
                    
                    container.appendChild(empDiv);
                });
        }
        
        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
        function changeEmployeeStatus(employeeId, newStatus) {
            const employee = employeesData.find(e => e.id == employeeId);
            if (!employee) return;
            
            // –ï—Å–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –±—ã–ª –Ω–∞ —É—á–∞—Å—Ç–∫–µ, —É–¥–∞–ª—è–µ–º –µ–≥–æ –æ—Ç—Ç—É–¥–∞
            if (newStatus !== 'active' && isEmployeeAssigned(employeeId)) {
                for (const areaId in currentAssignment) {
                    if (currentAssignment[areaId].includes(employeeId)) {
                        removeEmployeeFromArea(employeeId, areaId);
                        break;
                    }
                }
            }
            
            employee.status = newStatus;
            renderAreas();
            renderEmployees();
            updateCounter();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è drag and drop
        function dragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.employeeId);
            e.dataTransfer.setData('source', 'employees-list');
            e.dataTransfer.setData('status', e.target.closest('.employee-item').className.match(/vacation|sick|dayoff/)?.[0]);
        }
        
        function dragOver(e) {
            e.preventDefault();
        }
        
        function drop(e) {
            e.preventDefault();
            const employeeId = e.dataTransfer.getData('text/plain');
            const source = e.dataTransfer.getData('source');
            const status = e.dataTransfer.getData('status');
            const targetAreaId = e.target.closest('.employees-cell')?.dataset.areaId;
            
            if (source === 'employees-list' && targetAreaId) {
                // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–∞ —É—á–∞—Å—Ç–æ–∫
                if (status && status !== 'active') {
                    alert('–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–≤ –æ—Ç–ø—É—Å–∫–µ/–Ω–∞ –±–æ–ª—å–Ω–∏—á–Ω–æ–º/–≤ –æ—Ç–≥—É–ª–µ)');
                    return;
                }
                addEmployeeToAreaById(employeeId, targetAreaId);
            }
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–∞ —É—á–∞—Å—Ç–æ–∫ –ø–æ ID
        function addEmployeeToAreaById(employeeId, areaId) {
            const employee = employeesData.find(e => e.id == employeeId);
            
            if (!employee || employee.status !== 'active') {
                alert('–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–≤ –æ—Ç–ø—É—Å–∫–µ/–Ω–∞ –±–æ–ª—å–Ω–∏—á–Ω–æ–º/–≤ –æ—Ç–≥—É–ª–µ)');
                return;
            }
            
            if (isEmployeeAssigned(employeeId)) {
                alert('–≠—Ç–æ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ —É–∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ –¥—Ä—É–≥–æ–π —É—á–∞—Å—Ç–æ–∫');
                return;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–∞ —É—á–∞—Å—Ç–æ–∫
            if (!currentAssignment[areaId]) {
                currentAssignment[areaId] = [];
            }
            
            currentAssignment[areaId].push(employeeId);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            renderAreas();
            renderEmployees();
            updateCounter();
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ —Å —É—á–∞—Å—Ç–∫–∞
        function removeEmployeeFromArea(employeeId, areaId) {
            if (currentAssignment[areaId]) {
                currentAssignment[areaId] = currentAssignment[areaId].filter(id => id != employeeId);
                
                if (currentAssignment[areaId].length === 0) {
                    delete currentAssignment[areaId];
                }
                
                renderAreas();
                renderEmployees();
                updateCounter();
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω–∞–∑–Ω–∞—á–µ–Ω –ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –Ω–∞ –∫–∞–∫–æ–π-–ª–∏–±–æ —É—á–∞—Å—Ç–æ–∫
        function isEmployeeAssigned(employeeId) {
            for (const areaId in currentAssignment) {
                if (currentAssignment[areaId].includes(employeeId)) {
                    return true;
                }
            }
            return false;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        function updateCounter() {
            let count = 0;
            
            for (const areaId in currentAssignment) {
                count += currentAssignment[areaId].length;
            }
            
            document.getElementById('assignedCount').textContent = count;
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –∞—Ä—Ö–∏–≤
        function saveAssignment() {
            const date = new Date();
            const dateStr = date.toLocaleString('ru-RU', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            const assignment = {
                id: Date.now(),
                name: `–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç ${dateStr}`,
                date: date.toISOString(),
                data: JSON.parse(JSON.stringify(currentAssignment))
            };
            
            archive.unshift(assignment);
            saveArchive();
            renderArchive();
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π
        function clearAllAssignments() {
            currentAssignment = {};
            renderAreas();
            renderEmployees();
            updateCounter();
            hideConfirmClearModal();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏
        function showConfirmClearModal() {
            document.getElementById('confirmClearModal').style.display = 'flex';
        }
        
        // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏
        function hideConfirmClearModal() {
            document.getElementById('confirmClearModal').style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è
        function showConfirmDeleteModal(itemId) {
            itemToDelete = itemId;
            document.getElementById('confirmDeleteModal').style.display = 'flex';
        }
        
        // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è
        function hideConfirmDeleteModal() {
            itemToDelete = null;
            document.getElementById('confirmDeleteModal').style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è
        function showEditNameModal(itemId, currentName) {
            itemToEdit = itemId;
            document.getElementById('editNameInput').value = currentName;
            document.getElementById('editNameModal').style.display = 'flex';
        }
        
        // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è
        function hideEditNameModal() {
            itemToEdit = null;
            document.getElementById('editNameModal').style.display = 'none';
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–∑ –∞—Ä—Ö–∏–≤–∞
        function deleteArchiveItem() {
            if (itemToDelete) {
                archive = archive.filter(item => item.id != itemToDelete);
                saveArchive();
                renderArchive();
                hideConfirmDeleteModal();
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è
        function saveEditedName() {
            if (itemToEdit) {
                const newName = document.getElementById('editNameInput').value.trim();
                if (newName) {
                    const item = archive.find(item => item.id == itemToEdit);
                    if (item) {
                        item.name = newName;
                        saveArchive();
                        renderArchive();
                    }
                }
                hideEditNameModal();
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ö–∏–≤–∞ –∏–∑ localStorage
        function loadArchive() {
            const savedArchive = localStorage.getItem('personnelAssignmentsArchive');
            if (savedArchive) {
                archive = JSON.parse(savedArchive);
                renderArchive();
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –≤ localStorage
        function saveArchive() {
            localStorage.setItem('personnelAssignmentsArchive', JSON.stringify(archive));
        }
        
        // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–æ–∫
        function renderArchive() {
            const archiveList = document.getElementById('archiveList');
            archiveList.innerHTML = '';
            
            if (archive.length === 0) {
                archiveList.innerHTML = '<p>–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–æ–∫</p>';
                return;
            }
            
            archive.forEach(item => {
                const div = document.createElement('div');
                div.className = 'archive-item';
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'archive-item-name';
                nameSpan.textContent = item.name;
                nameSpan.addEventListener('click', () => loadFromArchive(item.id));
                
                const controlsDiv = document.createElement('div');
                controlsDiv.className = 'archive-item-controls';
                
                const editBtn = document.createElement('button');
                editBtn.textContent = '‚úèÔ∏è';
                editBtn.title = '–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å';
                editBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    showEditNameModal(item.id, item.name);
                });
                
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'üóëÔ∏è';
                deleteBtn.title = '–£–¥–∞–ª–∏—Ç—å';
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    showConfirmDeleteModal(item.id);
                });
                
                controlsDiv.appendChild(editBtn);
                controlsDiv.appendChild(deleteBtn);
                
                div.appendChild(nameSpan);
                div.appendChild(controlsDiv);
                
                archiveList.appendChild(div);
            });
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–∑ –∞—Ä—Ö–∏–≤–∞
        function loadFromArchive(id) {
            const assignment = archive.find(item => item.id == id);
            if (assignment) {
                currentAssignment = JSON.parse(JSON.stringify(assignment.data));
                renderAreas();
                renderEmployees();
                updateCounter();
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>